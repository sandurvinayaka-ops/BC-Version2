<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Birth Pulse - Cinematic TV Pro V53</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body, html {
            margin: 0; padding: 0; width: 100vw; height: 100vh;
            overflow: hidden; background-color: #000000;
            font-family: Arial, Helvetica, sans-serif; color: white;
            cursor: grab; touch-action: none;
        }
        body:active { cursor: grabbing; }

        /* 1. TOP-LEFT HEADER BOX */
        .header-box {
            position: absolute; top: 5vh; left: 5vw;
            z-index: 500; pointer-events: auto; text-align: left;
        }
        .philips-text { display: flex; margin-bottom: 5px; }
        .philips-text span {
            font-size: 2.2vw; font-weight: 900; letter-spacing: 0.3vw;
            transition: color 0.8s ease, text-shadow 0.8s ease;
            text-transform: uppercase;
        }
        .main-heading {
            font-size: 3.1vw; color: #a855f7; 
            font-weight: 800; text-shadow: 0 0 30px rgba(168, 85, 247, 0.6);
            white-space: nowrap;
        }

        /* 2. BOTTOM-LEFT STATS PANEL (Moved to avoid Sun overlap) */
        .stats-box { 
            position: absolute; 
            bottom: 8vh; /* Moved to bottom */
            left: 5vw; 
            width: 38vw; 
            z-index: 100;
            pointer-events: auto; text-align: left;
        }
        .label { font-size: 1.2vw; color: #38bdf8; text-transform: uppercase; font-weight: 900; letter-spacing: 3px; }
        .count {
            font-size: 8.5vw; font-weight: 900; color: #fbbf24;
            line-height: 1.1; margin: 5px 0; 
            text-shadow: 0 0 30px rgba(250, 204, 21, 0.4);
        }

        /* PROGRESS BAR */
        .progress-container { width: 35vw; margin-top: 10px; }
        .top-labels { display: flex; justify-content: space-between; width: 100%; margin-bottom: 5px; }
        .limit-text { color: #38bdf8; font-size: 1.1vw; font-weight: bold; opacity: 0.8; }
        .bar-wrapper { width: 100%; height: 14px; background: rgba(255,255,255,0.05); border-radius: 20px; border: 1px solid rgba(255,255,255,0.15); overflow: hidden; }
        .bar-fill { height: 100%; width: 0%; background: linear-gradient(90deg, #f59e0b, #fbbf24); box-shadow: 0 0 15px rgba(251, 191, 36, 0.5); }
        .bottom-clock { width: 100%; text-align: center; margin-top: 12px; }
        #clock { color: #fbbf24; font-size: 1.8vw; font-weight: bold; letter-spacing: 3px; }

        .globe-container { position: absolute; left: 0; top: 0; width: 100vw; height: 100vh; z-index: 5; }
        #main-canvas { width: 100%; height: 100%; }

        #loading {
            position: absolute; width: 100%; height: 100%;
            background: #000000; display: flex; align-items: center; 
            justify-content: center; z-index: 2000; color: #38bdf8; font-size: 2.5vw;
        }
    </style>
</head>
<body>

    <div id="loading">CLEARING TEXT OVERLAP...</div>
    
    <div class="header-box">
        <div id="philips-text" class="philips-text">
            <span>P</span><span>H</span><span>I</span><span>L</span><span>I</span><span>P</span><span>S</span>
        </div>
        <h1 class="main-heading">Mother & Child Care-Women's Health</h1>
    </div>

    <div class="stats-box">
        <span class="label">Global Birth Count Today</span>
        <div id="birthCount" class="count">0</div>
        
        <div class="progress-container">
            <div class="top-labels">
                <span class="limit-text">00:00</span>
                <span class="limit-text">24:00</span>
            </div>
            <div class="bar-wrapper">
                <div id="bar" class="bar-fill"></div>
            </div>
            <div class="bottom-clock">
                <span id="clock">00:00:00</span>
            </div>
        </div>
    </div>

    <div class="stars-container" id="starfield"></div>

    <div class="globe-container">
        <canvas id="main-canvas"></canvas>
    </div>

    <script>
        var BIRTH_RATE = 4.34;
        var AUTO_ROTATION_SPEED = 0.55;
        
        var globeThemes = [
            { land: "#4ade80", flash: "#f472b6", ocean: "#0a192f" },
            { land: "#fb7185", flash: "#22d3ee", ocean: "#1e0108" },
            { land: "#22d3ee", flash: "#fbbf24", ocean: "#042f2e" },
            { land: "#facc15", flash: "#a855f7", ocean: "#1e0a01" }
        ];
        var currentThemeIdx = 0;

        var planets = [
            { name: "Mercury", dist: 120, size: 3, speed: 0.015, color: "#9ca3af", angle: Math.random()*7 },
            { name: "Venus",   dist: 160, size: 5, speed: 0.011, color: "#fb923c", angle: Math.random()*7 },
            { name: "Mars",    dist: 220, size: 4, speed: 0.008, color: "#f87171", angle: Math.random()*7 },
            { name: "Jupiter", dist: 300, size: 10, speed: 0.005, color: "#d1d5db", angle: Math.random()*7 },
            { name: "Saturn",  dist: 380, size: 8, speed: 0.003, color: "#fde68a", angle: Math.random()*7 },
            { name: "Uranus",  dist: 450, size: 6, speed: 0.002, color: "#7dd3fc", angle: Math.random()*7 },
            { name: "Neptune", dist: 520, size: 6, speed: 0.001, color: "#6366f1", angle: Math.random()*7 }
        ];
        
        var worldData = null, flashingISO = {}, stars = [], comets = [];
        var canvas = document.getElementById("main-canvas");
        var context = canvas.getContext("2d");
        var w, h, isDragging = false, lastX, lastY, rotX = 0, rotY = -15;

        function setSizes() { w = window.innerWidth; h = window.innerHeight; canvas.width = w; canvas.height = h; }
        setSizes();

        var projection = d3.geoOrthographic().scale(h / 2.8).translate([w * 0.74, h * 0.5]).clipAngle(90);
        var path = d3.geoPath(projection, context);

        function handleStart(x, y) { isDragging = true; lastX = x; lastY = y; }
        function handleMove(x, y) { if (isDragging) { rotX += (x - lastX)*0.3; rotY -= (y - lastY)*0.3; lastX = x; lastY = y; } }
        canvas.addEventListener('mousedown', function(e) { handleStart(e.clientX, e.clientY); });
        window.addEventListener('mousemove', function(e) { handleMove(e.clientX, e.clientY); });
        window.addEventListener('mouseup', function() { isDragging = false; });
        canvas.addEventListener('touchstart', function(e) { e.preventDefault(); if(e.touches.length > 0) handleStart(e.touches[0].clientX, e.touches[0].clientY); }, {passive: false});
        window.addEventListener('touchmove', function(e) { e.preventDefault(); if(e.touches.length > 0) handleMove(e.touches[0].clientX, e.touches[0].clientY); }, {passive: false});
        window.addEventListener('touchend', function() { isDragging = false; });

        function updatePhilipsColors() {
            var spans = document.querySelectorAll('#philips-text span');
            for(var i=0; i<spans.length; i++) {
                var r = Math.floor(Math.random()*155)+100, g = Math.floor(Math.random()*155)+100, b = Math.floor(Math.random()*155)+100;
                var col = 'rgb('+r+','+g+','+b+')';
                spans[i].style.color = col; spans[i].style.textShadow = '0 0 15px '+col;
            }
        }

        for(var i=0; i<60; i++) stars.push({ x: Math.random()*w, y: Math.random()*h, sz: Math.random()*2 });

        setInterval(function() { currentThemeIdx = (currentThemeIdx + 1) % globeThemes.length; }, 180000);
        setInterval(updatePhilipsColors, 1200);

        function init() {
            d3.json("https://raw.githubusercontent.com/nvkelso/natural-earth-vector/master/geojson/ne_110m_admin_0_countries.geojson").then(function(data) {
                worldData = data;
                document.getElementById('loading').style.display = 'none';
                renderLoop();
                startSimulation();
            });
        }

        function renderLoop() {
            if (!isDragging) rotX += AUTO_ROTATION_SPEED;
            projection.rotate([rotX, rotY]);
            context.clearRect(0, 0, w, h);

            drawSolarSystem();

            // Stars
            context.fillStyle = "rgba(255,255,255,0.4)";
            for(var i=0; i<stars.length; i++) {
                context.beginPath(); context.arc(stars[i].x, stars[i].y, stars[i].sz, 0, 7); context.fill();
            }

            updateComets();

            var center = projection.translate(), radius = projection.scale(), theme = globeThemes[currentThemeIdx];

            // Globe Ocean
            var oceanGrad = context.createRadialGradient(center[0]-radius/2.5, center[1]-radius/2.5, radius/20, center[0], center[1], radius);
            oceanGrad.addColorStop(0, "#3b82f6"); oceanGrad.addColorStop(0.5, theme.ocean); oceanGrad.addColorStop(1, "#020617");
            context.beginPath(); context.arc(center[0], center[1], radius, 0, 7);
            context.fillStyle = oceanGrad; context.fill();

            if (worldData) {
                var now = Date.now();
                context.beginPath(); path(worldData);
                context.fillStyle = theme.land; context.fill();
                context.strokeStyle = "rgba(255, 255, 255, 0.4)"; context.lineWidth = 0.6; context.stroke();

                worldData.features.forEach(function(feature) {
                    var iso = feature.properties.ISO_A3 || feature.properties.ADM0_A3 || feature.id;
                    if (flashingISO[iso] && (now - flashingISO[iso] < 1500)) {
                        context.beginPath(); path(feature);
                        context.fillStyle = theme.flash;
                        context.fill();
                        context.strokeStyle = "white"; context.lineWidth = 1; context.stroke();
                    }
                });
            }
            requestAnimationFrame(renderLoop);
        }

        function drawSolarSystem() {
            var sunX = w * 0.25, sunY = h * 0.5;
            var sunGrad = context.createRadialGradient(sunX, sunY, 10, sunX, sunY, 60);
            sunGrad.addColorStop(0, "#fffbeb"); sunGrad.addColorStop(0.4, "#fbbf24"); sunGrad.addColorStop(1, "transparent");
            context.save();
            context.shadowBlur = 50; context.shadowColor = "#f59e0b";
            context.beginPath(); context.arc(sunX, sunY, 50, 0, 7);
            context.fillStyle = sunGrad; context.fill();
            context.restore();

            for(var i=0; i<planets.length; i++) {
                var p = planets[i];
                p.angle += p.speed * 0.5;
                var px = sunX + Math.cos(p.angle) * p.dist;
                var py = sunY + Math.sin(p.angle) * p.dist * 0.6;
                context.beginPath(); context.ellipse(sunX, sunY, p.dist, p.dist * 0.6, 0, 0, 7);
                context.strokeStyle = "rgba(255,255,255,0.05)"; context.stroke();
                context.beginPath(); context.arc(px, py, p.size, 0, 7);
                context.fillStyle = p.color; context.fill();
            }
        }

        function updateComets() {
            if (Math.random() > 0.996) comets.push({ x: Math.random()*w, y: -100, vx: -18, vy: 14, life: 1 });
            for (var i = 0; i < comets.length; i++) {
                var c = comets[i];
                var g = context.createLinearGradient(c.x, c.y, c.x + 200, c.y - 150);
                g.addColorStop(0, "white"); g.addColorStop(0.5, "rgba(168, 85, 247, 0.4)"); g.addColorStop(1, "transparent");
                context.strokeStyle = g; context.lineWidth = 5; context.lineCap = "round";
                context.beginPath(); context.moveTo(c.x, c.y); context.lineTo(c.x + 220, c.y - 170); context.stroke();
                context.fillStyle = "white"; context.beginPath(); context.arc(c.x, c.y, 3, 0, 7); context.fill();
                c.x += c.vx; c.y += c.vy; c.life -= 0.008;
                if(c.life <= 0) { comets.splice(i, 1); i--; }
            }
        }

        function startSimulation() {
            setInterval(function() {
                var now = new Date(), start = new Date(now.getFullYear(), now.getMonth(), now.getDate()).getTime();
                var elapsed = (Date.now() - start) / 1000, total = Math.floor(elapsed * BIRTH_RATE);
                document.getElementById('birthCount').innerText = total.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
                document.getElementById('clock').innerText = now.toLocaleTimeString('en-GB');
                document.getElementById('bar').style.width = (elapsed / 86400 * 100) + "%";
                if (worldData) {
                    var idx = Math.floor(Math.random() * worldData.features.length);
                    var iso = worldData.features[idx].properties.ISO_A3 || worldData.features[idx].properties.ADM0_A3 || worldData.features[idx].id;
                    flashingISO[iso] = Date.now();
                }
            }, 1000 / BIRTH_RATE);
        }

        window.onresize = setSizes;
        init();
    </script>
</body>
</html>