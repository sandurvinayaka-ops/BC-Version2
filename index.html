<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Birth Pulse 2025 - Cinematic TV Edition</title>
    <script src="https://unpkg.com/globe.gl"></script>
    <style>
        :root {
            --bg-color: #010409;
            --gold-flash: #fbbf24; 
            --purple-text: #a855f7;
            --map-blue: #38bdf8;   
        }
        body, html {
            margin: 0; padding: 0; width: 100vw; height: 100vh;
            overflow: hidden; background-color: var(--bg-color);
            font-family: 'Segoe UI', Roboto, sans-serif;
            color: white;
        }

        /* High-Performance Starfield (CSS Twinkle) */
        .stars-bg {
            position: absolute; width: 100%; height: 100%;
            background: radial-gradient(circle at 50% 50%, #0f172a 0%, #010409 100%);
            z-index: 1;
        }
        .star {
            position: absolute; background: white; border-radius: 50%;
            animation: twinkle var(--t) infinite ease-in-out;
        }
        @keyframes twinkle { 0%, 100% { opacity: 0.2; transform: scale(1); } 50% { opacity: 1; transform: scale(1.3); } }

        #comet-canvas {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 100; pointer-events: none;
        }

        .main-heading {
            position: absolute; top: 7vh; left: 5vw;
            font-size: 2.8vw; color: var(--purple-text);
            font-weight: 800; text-transform: uppercase;
            letter-spacing: 2px; z-index: 110;
            text-shadow: 0 0 40px rgba(168, 85, 247, 0.8);
            margin: 0;
        }

        .container { 
            display: flex; width: 100%; height: 100%; 
            align-items: center; position: relative; z-index: 10;
        }

        .stats-panel { 
            padding-left: 6vw; width: 32vw;
            display: flex; flex-direction: column; justify-content: center;
            z-index: 120;
        }

        .label { font-size: 1.3vw; color: var(--map-blue); letter-spacing: 3px; text-transform: uppercase; font-weight: bold; }
        .count {
            font-size: 8.5vw; font-weight: 900; color: var(--gold-flash); line-height: 1;
            filter: drop-shadow(0 0 25px rgba(251, 191, 36, 0.7)); margin: 1.5vh 0; 
            font-variant-numeric: tabular-nums;
        }
        .sub-text { font-size: 1.5vw; color: var(--map-blue); opacity: 0.8; }
        
        .progress-box { width: 95%; margin-top: 5vh; position: relative; }
        .bar-container { height: 10px; background: rgba(56, 189, 248, 0.1); border-radius: 20px; }
        .bar-fill { height: 100%; width: 0%; background: var(--gold-flash); box-shadow: 0 0 15px var(--gold-flash); border-radius: 20px;}
        #clock { color: var(--gold-flash); font-size: 2vw; font-weight: bold; display: block; margin-top: 20px; letter-spacing: 3px; }

        .globe-panel { 
            position: absolute; right: -8vw; width: 70vw; height: 100vh;
            z-index: 5; 
        }
        
        #globeViz { width: 100%; height: 100%; }

        #loading {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg-color); display: flex; align-items: center; 
            justify-content: center; z-index: 2000; color: var(--map-blue); font-size: 2.5vw;
        }
    </style>
</head>
<body>

    <div class="stars-bg" id="stars-bg"></div>
    <canvas id="comet-canvas"></canvas>
    
    <h1 class="main-heading">Mother & Child Care-Women's Health</h1>

    <div class="container">
        <div class="stats-panel">
            <div class="label">Global Births Today</div>
            <div id="birthCount" class="count">0</div>
            <div class="sub-text">new lives welcomed since midnight</div>
            <div class="progress-box">
                <div class="bar-container"><div id="bar" class="bar-fill"></div></div>
                <span id="clock">00:00:00</span>
            </div>
        </div>

        <div class="globe-panel">
            <div id="globeViz"></div>
        </div>
    </div>
    <div id="loading">SYNCHRONIZING GLOBAL PULSE...</div>

    <script>
        const countryShares = { IND: 18.29, CHN: 17.69, USA: 4.34, IDN: 3.57, PAK: 3.19, NGA: 2.97, BRA: 2.66, BGD: 2.19, RUS: 1.80, ETH: 1.69, MEX: 1.65, JPN: 1.54, EGY: 1.48, PHL: 1.46, COD: 1.41, VNM: 1.27, IRN: 1.15, TUR: 1.10, DEU: 1.05, THA: 0.89, TZA: 0.88, GBR: 0.87, FRA: 0.83, ZAF: 0.81, ITA: 0.74, KEN: 0.72, MMR: 0.69, COL: 0.67, KOR: 0.65, SDN: 0.65, UGA: 0.64, ESP: 0.60, DZA: 0.59, IRQ: 0.59, ARG: 0.57, AFG: 0.55, YEM: 0.52, CAN: 0.50, AGO: 0.49, UKR: 0.49, MAR: 0.48, POL: 0.48, UZB: 0.46, MYS: 0.45, MOZ: 0.45, GHA: 0.44, PER: 0.43, SAU: 0.43, MDG: 0.41, CIV: 0.41, CMR: 0.37, NPL: 0.37, VEN: 0.36, NER: 0.35, AUS: 0.34, PRK: 0.33, SYR: 0.32, MLI: 0.31, BFA: 0.30, MWI: 0.28, ZMB: 0.27, TCD: 0.26, KAZ: 0.26, CHL: 0.25, SOM: 0.25, SEN: 0.24, ROU: 0.24, GTM: 0.23, NLD: 0.23, ECU: 0.23, KHM: 0.22, ZWE: 0.21, GIN: 0.19, BEN: 0.19, RWA: 0.18, BDI: 0.18, BOL: 0.16, TUN: 0.15, SSD: 0.15, HTI: 0.15, BEL: 0.15, JOR: 0.14, DOM: 0.14, ARE: 0.14, HND: 0.14, CUB: 0.14, TJK: 0.13, PNG: 0.13, SWE: 0.13, CZE: 0.13, PRT: 0.13, AZE: 0.13, GRC: 0.12, TGO: 0.12, HUN: 0.12, ISR: 0.12, AUT: 0.11, BLR: 0.11, CHE: 0.11, SLE: 0.11, LAO: 0.10, TKM: 0.10, LBY: 0.09, HKG: 0.09, KGZ: 0.09, PRY: 0.09, NIC: 0.09, BGR: 0.08, SRB: 0.08, COG: 0.08, SLV: 0.08, DNK: 0.07, SGP: 0.07, LBN: 0.07, LBR: 0.07, FIN: 0.07, NOR: 0.07, PSE: 0.07, CAF: 0.07, OMN: 0.07, SVK: 0.07, MRT: 0.07, IRL: 0.07, NZL: 0.07, CRI: 0.06, KWT: 0.06, PAN: 0.06, HRV: 0.05, GEO: 0.05, ERI: 0.05, MNG: 0.04, URU: 0.04, PRI: 0.04, BIH: 0.04, QAT: 0.04, NAM: 0.04, MDA: 0.04, ARM: 0.04, JAM: 0.04, LTU: 0.04, GMB: 0.04, ALB: 0.03, GAB: 0.03, BWA: 0.03, LSO: 0.03, GNB: 0.03, SVN: 0.03, GNQ: 0.02, LVA: 0.02, MKD: 0.02, BHR: 0.02, TTO: 0.02, TLS: 0.02, CYP: 0.02, EST: 0.02, MUS: 0.02, SWZ: 0.02, DJB: 0.01, FJI: 0.01, COM: 0.01, REU: 0.01, SLB: 0.01, GUY: 0.01, BTN: 0.01, MAC: 0.01, LUX: 0.01, SUR: 0.01, MNE: 0.01, ESH: 0.01, MLT: 0.01, MDV: 0.01, CPV: 0.01, BRN: 0.01, BLZ: 0.01, BHS: 0.01, ISL: 0.01, GLP: 0.01, MTQ: 0.01, MYT: 0.01, VUT: 0.01, GUF: 0.01, NCL: 0.01, BRB: 0.01, PYF: 0.01, STP: 0.01, WSM: 0.01, CUW: 0.01, LCA: 0.01, GUM: 0.01, KIR: 0.01, SYC: 0.01, GRD: 0.01, FSM: 0.01, ABW: 0.01, JEY: 0.01, TON: 0.01, VCT: 0.01, ATG: 0.01, VIR: 0.01, IMN: 0.01, AND: 0.01, CYM: 0.01, DMA: 0.01, BMU: 0.01, GGY: 0.01, FRO: 0.01, GRL: 0.01, KNA: 0.01, TCA: 0.01, ASM: 0.01, SXM: 0.01, MNP: 0.01, LIE: 0.01, GIB: 0.01, VGB: 0.01, MCO: 0.01, MHL: 0.01, SMR: 0.01, MAF: 0.01, PLW: 0.01, AIA: 0.01, COK: 0.01, NRU: 0.01, BLM: 0.01, WLF: 0.01, TUV: 0.01, SPM: 0.01, SHN: 0.01, MSR: 0.01, FLK: 0.01, TKL: 0.01, NIU: 0.01, VAT: 0.0 };
        const BIRTH_RATE = 367000 / 86400000;
        const FADE_TIME = 2500; 

        let worldData = [], flashingCountries = new Map(), globe, isDirty = false;

        // --- OPTIMIZED CSS STARS ---
        function initStars() {
            const bg = document.getElementById('stars-bg');
            for(let i=0; i<100; i++) {
                const s = document.createElement('div');
                s.className = 'star';
                s.style.left = Math.random()*100 + '%';
                s.style.top = Math.random()*100 + '%';
                const size = (Math.random()*2.5) + 'px';
                s.style.width = size; s.style.height = size;
                s.style.setProperty('--t', (3 + Math.random()*5) + 's');
                bg.appendChild(s);
            }
        }

        // --- CINEMATIC COMETS ---
        const cCanvas = document.getElementById('comet-canvas');
        const cCtx = cCanvas.getContext('2d');
        let comets = [];

        function drawComets() {
            cCanvas.width = window.innerWidth;
            cCanvas.height = window.innerHeight;
            cCtx.clearRect(0, 0, cCanvas.width, cCanvas.height);
            
            if (Math.random() > 0.997) {
                comets.push({ x: Math.random()*cCanvas.width, y: -50, vx: -12, vy: 9, l: 1 });
            }

            comets.forEach((c, i) => {
                const g = cCtx.createLinearGradient(c.x, c.y, c.x + 80, c.y - 60);
                g.addColorStop(0, `rgba(255, 255, 255, ${c.l})`);
                g.addColorStop(1, 'rgba(168, 85, 247, 0)');
                cCtx.strokeStyle = g; cCtx.lineWidth = 3; cCtx.lineCap = 'round';
                cCtx.beginPath(); cCtx.moveTo(c.x, c.y); cCtx.lineTo(c.x + 90, c.y - 65); cCtx.stroke();
                
                c.x += c.vx; c.y += c.vy; c.l -= 0.006;
                if(c.l <= 0) comets.splice(i, 1);
            });
            requestAnimationFrame(drawComets);
        }

        // --- SIMULATION ---
        function startSimulation() {
            let lastT = Date.now(), carry = 0;
            
            // Stats Update
            setInterval(() => {
                const now = new Date();
                const start = new Date(now.getFullYear(), now.getMonth(), now.getDate());
                let num = Math.floor((now - start) * BIRTH_RATE);
                document.getElementById('birthCount').innerText = num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
                document.getElementById('clock').innerText = now.toLocaleTimeString('en-GB');
                document.getElementById('bar').style.width = (((now - start) / 86400000) * 100) + "%";
            }, 1000);

            // Logic Loop
            function logic() {
                const now = Date.now();
                carry += Math.min(now - lastT, 1000) * BIRTH_RATE;
                lastT = now;
                
                while (carry >= 1) { 
                    triggerFlash(); 
                    carry--; 
                }

                if (isDirty || flashingCountries.size > 0) {
                    let changed = false;
                    for (const [iso, start] of flashingCountries) {
                        if (now - start > FADE_TIME) {
                            flashingCountries.delete(iso);
                            changed = true;
                        }
                    }
                    // Only tell globe to update if the state changed
                    if (globe && (isDirty || changed)) {
                        globe.polygonCapColor(globe.polygonCapColor());
                        isDirty = false;
                    }
                }
                requestAnimationFrame(logic);
            }
            logic();
        }

        function triggerFlash() {
            const total = worldData.reduce((s, i) => s + i.properties.weight, 0);
            let r = Math.random() * total;
            for (let f of worldData) {
                r -= f.properties.weight;
                if (r <= 0) {
                    flashingCountries.set(f.properties.isoCode, Date.now());
                    isDirty = true; // Mark for render
                    break;
                }
            }
        }

        function initGlobe(countries) {
            countries.features.forEach(f => {
                let iso = f.properties.ISO_A3 || f.properties.ADM0_A3;
                f.properties.isoCode = iso;
                f.properties.weight = countryShares[iso] || 0.01;
                worldData.push(f);
            });

            globe = Globe()
                .width(document.querySelector('.globe-panel').clientWidth)
                .height(window.innerHeight)
                .backgroundColor('rgba(0,0,0,0)')
                .showAtmosphere(true)
                .atmosphereColor('#38bdf8')
                .atmosphereAltitude(0.22)
                .globeImageUrl('//unpkg.com/three-globe/example/img/earth-night.jpg')
                .polygonsData(countries.features)
                .polygonSideColor(() => 'rgba(0,0,0,0)')
                .polygonStrokeColor(() => 'rgba(168, 85, 247, 0.4)')
                .polygonCapColor(d => {
                    const start = flashingCountries.get(d.properties.isoCode);
                    if (start) {
                        const p = 1 - Math.min((Date.now() - start) / FADE_TIME, 1);
                        // GOLD FLASH for the whole country
                        return `rgba(251, 191, 36, ${0.3 + (p * 0.7)})`;
                    }
                    return 'rgba(10, 25, 47, 0.9)'; // Solid Navy land
                })
                .polygonAltitude(d => flashingCountries.has(d.properties.isoCode) ? 0.03 : 0.01)
                (document.getElementById('globeViz'));

            // Hardware Accelerated Rotation
            globe.controls().autoRotate = true;
            globe.controls().autoRotateSpeed = 0.48;
            globe.controls().enableZoom = false;
            
            // Size: 0.9x current (Altitude 1.9)
            globe.pointOfView({ lat: 10, lng: 10, altitude: 1.9 });

            document.getElementById('loading').style.display = 'none';
            initStars();
            drawComets();
            startSimulation();
        }

        fetch("https://raw.githubusercontent.com/nvkelso/natural-earth-vector/master/geojson/ne_110m_admin_0_countries.geojson")
            .then(r => r.json()).then(initGlobe);
    </script>
</body>
</html>