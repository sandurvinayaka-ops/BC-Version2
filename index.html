<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Birth Pulse - TV Smooth Edition</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body, html {
            margin: 0; padding: 0; width: 100vw; height: 100vh;
            overflow: hidden; background-color: #010409;
            font-family: 'Plus Jakarta Sans', Arial, sans-serif; color: white;
        }

        /* REALISTIC SPACE BACKGROUND */
        .stars-container {
            position: absolute; width: 100%; height: 100%;
            background: radial-gradient(circle at center, #1B2735 0%, #090A0F 100%);
            z-index: 0;
        }
        .star {
            position: absolute; background: white; border-radius: 50%;
            animation: twinkle var(--duration) infinite ease-in-out;
        }
        @keyframes twinkle { 0%, 100% { opacity: 0.3; } 50% { opacity: 1; } }

        .globe-container {
            position: fixed; right: -10%; top: 0; width: 80%; height: 100%; z-index: 1;
        }

        .ui-overlay {
            position: relative; z-index: 10; pointer-events: none;
            height: 100vh; padding: 5vh 5vw;
            display: flex; flex-direction: column; justify-content: space-between;
        }

        .neon-text { text-shadow: 0 0 30px rgba(250, 204, 21, 0.6); }

        #comet-canvas {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 2; pointer-events: none;
        }
    </style>
</head>
<body>

    <div class="stars-container" id="starfield"></div>
    <canvas id="comet-canvas"></canvas>

    <div class="globe-container" id="globe-parent">
        <svg id="globe-svg" style="width: 100%; height: 100%; overflow: visible;"></svg>
    </div>

    <div class="ui-overlay">
        <!-- HEADER -->
        <div>
            <h1 class="text-[2.5vw] font-black text-[#D946EF] tracking-[0.3em] uppercase">
                Mother & Child Care — Women's Health
            </h1>
            <div class="h-[4px] w-[35vw] bg-yellow-500 shadow-[0_0_20px_rgba(234,179,8,0.7)] mt-2"></div>
        </div>

        <!-- STATS CENTRE LEFT -->
        <div class="flex flex-col gap-4">
            <span class="text-[1.2vw] font-black tracking-[0.5em] text-yellow-500/80 uppercase">Global Birth Count Today</span>
            <div id="birthCount" class="text-[9vw] font-black text-yellow-400 tabular-nums leading-none neon-text">
                0
            </div>
            
            <div class="mt-8 space-y-4">
                <div class="flex justify-between w-[30vw] text-[1vw] font-bold tracking-widest text-slate-500 uppercase">
                    <span>Diurnal Phase</span>
                    <span id="sync-text" class="text-yellow-500">0% Synchronized</span>
                </div>
                <div class="h-3 w-[30vw] bg-slate-900 border border-slate-800 rounded-full overflow-hidden">
                    <div id="progress-bar" class="h-full bg-yellow-500 shadow-[0_0_20px_#eab308] transition-all duration-1000 linear" style="width: 0%"></div>
                </div>
                <div class="inline-block bg-black/50 border border-yellow-500/20 px-8 py-4 rounded-xl mt-4">
                    <span id="clock" class="text-yellow-400 font-bold tabular-nums tracking-[0.3em] text-[1.8vw]">00:00:00</span>
                </div>
            </div>
        </div>

        <!-- FOOTER -->
        <div class="text-[0.8vw] font-bold text-slate-600 tracking-[0.5em] uppercase">
            Active Telemetry Stream — Source: Demographic Matrix
        </div>
    </div>

    <script>
        // --- CONFIGURATION ---
        var BIRTH_RATE = 4.34;
        var ROTATION_SPEED = 0.22;
        var PACIFIER_PATH = "M12 2C8.13 2 5 5.13 5 9c0 2.38 1.19 4.47 3 5.74V17c0 .55.45 1 1 1h6c.55 0 1-.45 1-1v-2.26c1.81-1.27 3-3.36 3-5.74 0-3.87-3.13-7-7-7zm2 14h-4v-1h4v1zm.65-3.07l-.65.46V14h-4v-.61l-.65-.46C8.52 12.33 8 11.23 8 10c0-2.21 1.79-4 4-4s4 1.79 4 4c0 1.23-.52 2.33-1.35 2.93z";

        // --- GLOBE ENGINE (D3 Restored) ---
        var svg = d3.select("#globe-svg");
        var width = window.innerWidth * 0.8;
        var height = window.innerHeight;
        var rotation = 0;

        var projection = d3.geoOrthographic()
            .scale(height / 2.3)
            .translate([width / 1.8, height / 2])
            .clipAngle(90);

        var path = d3.geoPath().projection(projection);

        function initGlobe() {
            d3.json("https://raw.githubusercontent.com/holtzy/D3-graph-gallery/master/DATA/world.geojson").then(function(geoData) {
                
                // Draw Sea
                svg.append("circle")
                    .attr("cx", width / 1.8).attr("cy", height / 2)
                    .attr("r", projection.scale())
                    .attr("fill", "#1e1b4b").attr("opacity", 0.8);

                var mapGroup = svg.append("g");
                var markerGroup = svg.append("g");

                d3.timer(function() {
                    rotation += ROTATION_SPEED;
                    projection.rotate([rotation, -12]);

                    mapGroup.selectAll(".country")
                        .data(geoData.features)
                        .join("path")
                        .attr("class", "country")
                        .attr("d", path)
                        .attr("fill", "#7c3aed")
                        .attr("stroke", "#a78bfa")
                        .attr("stroke-width", 0.5)
                        .attr("opacity", 0.7);

                    updateMarkers(markerGroup);
                });

                startSimulation();
            });
        }

        var activeMarkers = [];
        function updateMarkers(group) {
            var currentRot = projection.rotate();
            
            group.selectAll(".marker")
                .data(activeMarkers, function(d) { return d.id; })
                .join(
                    function(enter) {
                        var g = enter.append("g").attr("class", "marker");
                        g.append("path")
                            .attr("d", PACIFIER_PATH)
                            .attr("transform", "translate(-12,-12) scale(1.2)")
                            .attr("fill", "#FACC15");
                        g.append("circle")
                            .attr("r", 5).attr("fill", "none").attr("stroke", "#FACC15").attr("stroke-width", 2)
                            .transition().duration(2000).attr("r", 60).attr("opacity", 0).remove();
                        return g;
                    },
                    function(update) {
                        return update.attr("transform", function(d) {
                            var pos = projection([d.lng, d.lat]);
                            return pos ? "translate(" + pos[0] + "," + pos[1] + ")" : "translate(-100,-100)";
                        }).attr("opacity", function(d) {
                            var geoPoint = [d.lng, d.lat];
                            return d3.geoDistance([-currentRot[0], -currentRot[1]], geoPoint) < Math.PI/2 ? 1 : 0;
                        });
                    }
                );
        }

        function startSimulation() {
            setInterval(function() {
                var now = new Date();
                var start = new Date(now.getFullYear(), now.getMonth(), now.getDate()).getTime();
                var elapsed = (Date.now() - start) / 1000;
                var total = Math.floor(elapsed * BIRTH_RATE);
                
                document.getElementById('birthCount').innerText = total.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
                document.getElementById('clock').innerText = now.toLocaleTimeString('en-GB');
                
                var dayProgress = (elapsed / 86400) * 100;
                document.getElementById('progress-bar').style.width = dayProgress + "%";
                document.getElementById('sync-text').innerText = Math.round(dayProgress) + "% Synchronized";

                // Add random marker
                activeMarkers.push({
                    id: Math.random(),
                    lat: (Math.random() - 0.5) * 120,
                    lng: (Math.random() - 0.5) * 360
                });
                if(activeMarkers.length > 15) activeMarkers.shift();

            }, 1000 / BIRTH_RATE);
        }

        // --- STARS & COMETS ---
        function initStars() {
            var field = document.getElementById('starfield');
            for (var i = 0; i < 100; i++) {
                var s = document.createElement('div');
                s.className = 'star';
                s.style.width = s.style.height = (1 + Math.random() * 2) + 'px';
                s.style.left = Math.random() * 100 + '%';
                s.style.top = Math.random() * 100 + '%';
                s.style.setProperty('--duration', (2 + Math.random() * 3) + 's');
                field.appendChild(s);
            }
        }

        initStars();
        initGlobe();
    </script>
</body>
</html>